---
description: "Understanding user intent and context-aware clarification"
alwaysApply: true
globs: []
version: "3.0.0"
last_updated: "2025-11-10"
priority: CRITICAL
load_order: 1
---

# User Intent Understanding

## üö® CRITICAL: FIRST ACTION ON VAGUE QUERIES üö®

**Before ANY exploratory actions (searches, reads, commands), check if query is vague:**

### Vague Query Indicators:
- Single words or short titles (e.g., "Title Nov Week 3", "Week 3", "November")
- Short phrases without context (e.g., "Improve rules", "Fix this", "Handle it")
- Ambiguous requests where intent is unclear
- Queries that could mean multiple different things
- Exploratory/research questions without specific action
- **Ambiguous action phrases without scope** (e.g., "work on X", "improve X", "enhance X", "fix X")

### If Query is Vague ‚Üí STOP IMMEDIATELY:
1. ‚õî **DO NOT search** (no grep, no glob, no file exploration)
2. ‚õî **DO NOT read files** (not even PROJECTS_OVERVIEW.md yet)
3. ‚õî **DO NOT run commands**
4. ‚úÖ **ASK CLARIFYING QUESTIONS FIRST**
5. ‚úÖ **WAIT for user response**
6. ‚úÖ **THEN proceed with Smart Cascade**

**Only proceed to Smart Cascade if query is clear and unambiguous.**

---

## User Intent Principles

- **Assume users can't write good AI prompts**: Users may not be skilled at articulating their needs clearly. Strive to understand their underlying intent, not just literal words.
- **Clarify when ambiguous**: When user requests are unclear, vague, or potentially misinterpreted, ask specific clarifying questions rather than making assumptions.
- **Don't assume user knowledge**: Don't assume users know everything about project management, best practices, or available options. Provide context and explanations when helpful.
- **Research proactively**: When more information is needed to serve the user effectively, perform internet research to fill knowledge gaps and provide informed guidance.
- **Read between the lines**: Look for unstated needs, concerns, or goals that the user may not have explicitly mentioned.
- **Vague = ASK FIRST**: Vagueness is a signal to ask, not a puzzle to solve through exploration

---

## Context-Aware Clarification (For CLEAR Queries Only)

**PREREQUISITE: Query must be clear and unambiguous to use Smart Cascade.**

When requests are clear but need context:

1. **SMART CASCADE - Follow Project Hierarchy for Context**:
   - **Start at the top**: Read `PROJECTS_OVERVIEW.md` to check for relevant projects
   - **If relevant project found**: Read that project's `PROJECT_SUMMARY.md`
   - **If implementation details needed**: Read specific related code files mentioned in project summary
   - **If PROJECTS_OVERVIEW doesn't clarify ‚Üí ASK USER immediately**
   - **NEVER do blind searching**: No multiple greps, no searching everywhere, no exploratory codebase traversal
   - **Key principle**: Follow the documented hierarchy (Overview ‚Üí Project Summary ‚Üí Specific code), don't search blindly

2. **Challenge Vagueness Directly**: 
   - Call out why request is unclear ("This request is too vague to act on effectively")
   - Explain opportunity cost of vague requests (wrong assumptions, wasted effort)
   - Show specific examples of what could be misinterpreted

3. **Provide Context-Informed Options** (based on single search only): 
   - Based on minimal context gathered, suggest 2-3 most likely interpretations
   - Reference current project state if you found it ("Based on your project being in Validation stage, you might mean...")
   - If no clear context found, say so and provide generic options

4. **Ask Targeted Questions**: 
   - Use context to ask specific, non-leading questions
   - Avoid generic questions - make them relevant to current situation
   - Ask 2-3 questions maximum (don't overwhelm)

5. **Don't Guess**: 
   - If context doesn't clarify intent, ask user directly rather than assuming
   - Better to clarify than proceed with wrong assumption
   - **NEVER create files or take actions based on assumptions from vague queries**
   - If query is vague (single words, short phrases, ambiguous), ask clarifying questions FIRST

## Vague Request Handling Pattern

When user request is vague or could mean multiple things:

### PHASE 1: DETECTION & STOP (Before ANY Actions)
1. ‚õî **STOP IMMEDIATELY**: Do not create files, do not search, do not read files, do not make assumptions
2. ‚úÖ **ASK FIRST**: Request clarification before any exploratory actions
3. ‚è∏Ô∏è **WAIT**: Do not proceed until user clarifies intent

### PHASE 2: CLARIFICATION
4. **Challenge First**: "This request is too vague. Let me explain why clarity matters..."
5. **Provide Options**: Based on your knowledge of the system (not searches), suggest 2-3 likely interpretations
6. **Targeted Questions**: Ask 2-3 specific questions to disambiguate

### PHASE 3: ACTION (Only After Clarification)
7. **THEN Proceed with Smart Cascade**:
   - Now read `PROJECTS_OVERVIEW.md` if needed
   - If relevant project identified ‚Üí Read that `PROJECT_SUMMARY.md`
   - If specific code mentioned in summary ‚Üí Read those specific files
   - **If Overview doesn't clarify ‚Üí ASK again**
8. **Execute**: Only after full clarification, proceed with appropriate action

**CRITICAL RULES**: 
- ‚õî **Vague queries = ASK FIRST, search NEVER**
- ‚õî **NO blind searching EVER**: No multiple greps, no exploratory searching, no "let me look everywhere"
- ‚õî **Don't optimize for exploration, optimize for clarity**
- ‚úÖ **Default behavior for vague queries: ASK immediately, don't search**
- ‚úÖ **Follow documented hierarchy ONLY AFTER query is clear** (Overview ‚Üí Project Summary ‚Üí Specific code)
- ‚úÖ **Smart Cascade is for CLEAR queries that need context, not for VAGUE queries**

**Correct behavior flow:**
```
Vague Query ‚Üí ASK ‚Üí Get Clarity ‚Üí Smart Cascade (if needed) ‚Üí Act
NOT: Vague Query ‚Üí Search ‚Üí Search ‚Üí Search ‚Üí Read ‚Üí Ask
```

---

## üö® INTENT DETECTION: DISCUSS vs EXECUTE üö®

**CRITICAL: Determine if user wants discussion or implementation BEFORE taking action.**

### Two-Area System (Hybrid Approach)

**Area 1: Project Documentation** (`/project-management/` folder)
- Files: `PROJECT_SUMMARY.md`, `PROJECTS_OVERVIEW.md`, major project files
- Behavior: **Autonomous updates** after completion/plan finalization
- No approval needed for updates

**Area 2: Codebase** (rest of repository)
- Files: `.ts`, `.tsx`, `.py`, components, configs, etc.
- Behavior: **Discuss ‚Üí Suggest ‚Üí Approve ‚Üí Implement**
- Always requires approval before code changes

### DISCUSS-FIRST Triggers (Code Area):

These phrases mean "let's talk about this first, don't implement yet":
- **"work on"** (e.g., "work on X") ‚Üí DISCUSS scope, problems, approach
- **"improve"** (e.g., "improve X") ‚Üí DISCUSS what's wrong, what needs improving
- **"enhance"** (e.g., "enhance X") ‚Üí DISCUSS goals, priorities
- **"fix"** (e.g., "fix X" without specific error) ‚Üí DISCUSS what's broken, why
- **"look at"** (e.g., "look at X") ‚Üí DISCUSS what to examine, why
- **Any question** (e.g., "What about X?") ‚Üí ANSWER, don't implement
- **Exploratory phrases** (e.g., "thoughts on", "ideas for") ‚Üí DISCUSS only

**Default rule: Unless explicitly told to implement/build, ALWAYS discuss first.**

### EXECUTE Triggers (Code Area):

These phrases mean "go ahead and implement" (but still verify scope is clear):
- **"implement [specific thing]"** ‚Üí May execute if scope is clear
- **"build [specific thing]"** ‚Üí May execute if scope is clear
- **"create [specific thing]"** ‚Üí May execute if scope is clear
- **"add [specific feature/code]"** ‚Üí May execute if scope is clear

**Critical: Even with EXECUTE triggers, verify scope is clear before proceeding.**

### EXPLICIT DOC UPDATE Triggers (Override - Force Immediate Update):

These phrases force immediate PROJECT_SUMMARY.md updates:
- **"update project summary"** ‚Üí Update PROJECT_SUMMARY.md immediately
- **"log this as a decision"** ‚Üí Add to Decisions section immediately
- **"log this as a blocker"** ‚Üí Add to Blockers section immediately
- **"document this learning"** ‚Üí Add to Learnings section immediately
- **"add this to the project"** ‚Üí Update PROJECT_SUMMARY.md immediately

**Use case**: User wants to ensure something is documented now, not wait for completion

### Handling Pattern:

**When DISCUSS-FIRST trigger detected (Code Area):**
1. üõë **STOP**: Do NOT explore codebase, do NOT implement
2. üìñ **READ**: Read PROJECTS_OVERVIEW.md + relevant PROJECT_SUMMARY.md for context
3. üí¨ **DISCUSS**: Ask about current problems, goals, priorities (stay in chat)
4. üéØ **SUGGEST**: When plan is clear, suggest implementation approach
5. ‚è∏Ô∏è **WAIT**: Wait for user approval ("yes, let's do it", "go ahead", "implement this")
6. üöÄ **IMPLEMENT**: After approval, implement code changes
7. üìù **UPDATE**: After implementation complete, update PROJECT_SUMMARY.md

**When EXECUTE trigger detected (Code Area):**
1. ‚úÖ **VERIFY**: Check if scope is clear and specific
2. üìñ **READ**: Read PROJECTS_OVERVIEW.md + relevant PROJECT_SUMMARY.md for context
3. üéØ **CONFIRM**: Brief confirmation of what will be implemented
4. üöÄ **IMPLEMENT**: Proceed with implementation
5. üìù **UPDATE**: After implementation complete, update PROJECT_SUMMARY.md

**When EXPLICIT DOC UPDATE trigger detected:**
1. üìù **UPDATE IMMEDIATELY**: Update PROJECT_SUMMARY.md right away
2. No approval needed (project documentation area)

### Examples:

‚ùå **WRONG**:
```
User: "I want to work on medtech integration UI/UX improvement"
AI: [explores codebase, implements changes immediately]
```

‚úÖ **CORRECT**:
```
User: "I want to work on medtech integration UI/UX improvement"
AI: [Reads PROJECTS_OVERVIEW.md + medtech-integration/PROJECT_SUMMARY.md]
    
    "I've reviewed the medtech project context. Let's discuss what needs improving.
     
     What specific UI/UX problems are you experiencing? 
     What user feedback prompted this? 
     Which workflows feel clunky?"

User: "Upload is confusing, no drag-drop, errors are unclear"

AI: "Got it. I can add:
     1. Drag-and-drop file upload with visual feedback
     2. Improved error messages with actionable suggestions
     3. Upload progress indicators
     
     Would you like me to implement these improvements?"

User: "Yes, let's do it"

AI: [Implements changes]
    [After implementation complete: Updates PROJECT_SUMMARY.md]
```

‚ùå **WRONG**:
```
User: "Improve the error handling"
AI: [starts implementing error handling improvements immediately]
```

‚úÖ **CORRECT**:
```
User: "Improve the error handling"
AI: "What errors are you seeing? What's not working well?
     Let's identify the problems first, then prioritize improvements."
```

‚úÖ **CORRECT** (with EXECUTE trigger):
```
User: "Implement drag-and-drop file upload in the medtech widget"
AI: [Reads project context]
    "Got it - adding drag-and-drop to the medtech image widget.
     I'll implement dropzone with visual feedback and file validation.
     [proceeds with implementation]
     [After complete: Updates PROJECT_SUMMARY.md]"
```

‚úÖ **CORRECT** (EXPLICIT DOC UPDATE):
```
User: "Log this decision: we're deferring mobile app to Q2"
AI: [Immediately updates PROJECT_SUMMARY.md under Decisions]
    "Logged decision to defer mobile app to Q2 in your project summary."
```

---

# End of User Intent Understanding
