---
description: "Library & Open Source First - Search for existing solutions before building"
alwaysApply: true
globs: []
version: "2.0.0"
priority: NORMAL
last_updated: "2026-01-01"
---

# Library & Open Source First Approach

## Core Principle

**Before building anything, actively search for:**
1. Well-maintained libraries (npm/pnpm)
2. Popular open source repositories (GitHub)
3. Example implementations and patterns
4. Articles and tutorials (Stack Overflow, dev.to, Medium)

**USE AI WEB SEARCH CAPABILITIES TO FIND SOLUTIONS.**

This runs automatically during THINKING mode when planning code.

## When Building New Features

### Step 1: Active Search (Mandatory - Use Web Search Tool)

**This happens automatically in THINKING mode before showing pseudocode plan.**

When user says "build X", search these sources:

**1. npm/pnpm Registry:**
- Search: "[feature name] react typescript"
- Example: "image cropper react typescript"
- Look for packages with 1,000+ stars
- Check last updated date (prefer < 6 months ago)

**2. GitHub Repositories:**
- Search: "[feature name] [tech stack]"
- Example: "medical imaging next.js"
- Look for repos with:
  - 500+ stars (proven useful)
  - Recent commits (last 6 months)
  - Active issues/PRs (maintained)
  - Good README/documentation
  - Similar tech stack (Next.js, React, TypeScript)

**3. Stack Overflow:**
- Search: "[feature] implementation [stack]"
- Example: "FHIR API integration nodejs"
- Look for:
  - High-voted answers (50+ votes)
  - Recent activity (last 2 years)
  - Code examples
  - Performance/security considerations

**4. dev.to Articles:**
- Search: "[feature] tutorial [tech]"
- Example: "Next.js image upload tutorial"
- Look for:
  - Recent articles (last year)
  - Complete code examples
  - Best practices explained
  - Real-world use cases

**5. Medium Articles:**
- Search: "[feature] implementation guide"
- Example: "healthcare API integration best practices"
- Look for:
  - Detailed technical articles
  - Architecture explanations
  - Lessons learned / pitfalls
  - From credible authors

**6. Check Existing Stack:**
- Review package.json dependencies FIRST
- User might already have a library that solves this

### Step 2: Evaluate Findings

**For Libraries (npm):**
- âœ… 1,000+ stars (popular features)
- âœ… Recent commits (within 6 months)
- âœ… Active maintenance (issues being addressed)
- âœ… Good documentation
- âœ… TypeScript support
- âœ… Reasonable bundle size (< 100KB for most)
- âœ… License compatible (MIT, Apache, etc.)
- âœ… No critical security vulnerabilities

**For GitHub Repos (reference implementations):**
- âœ… 500+ stars (proven useful)
- âœ… Recent activity (not abandoned)
- âœ… Clear code structure (can learn from it)
- âœ… Similar tech stack (Next.js, React, TypeScript)
- âœ… Good README with architecture explanation

**For Stack Overflow / Articles:**
- âœ… From reputable sources (high reputation users, known publications)
- âœ… Recent content (last 1-2 years for tech)
- âœ… Applicable to your stack (Next.js, React, TypeScript)
- âœ… Solves similar problem
- âœ… Includes working code examples

### Step 3: Present Findings

After searching, present what you found BEFORE showing pseudocode:

**Format:**
```
I searched for solutions first:

ðŸ“¦ LIBRARIES FOUND:
- [library-name]: [stars] stars, last updated [date]
  âœ… Pros: [key benefits]
  âŒ Cons: [limitations]
  Bundle: [size]

ðŸ” GITHUB REPOS FOUND:
- [repo-name]: [stars] stars
  Description: [what it does]
  Useful for: [what we can learn/adapt]

ðŸ’¬ STACK OVERFLOW / ARTICLES:
- [title]: [source] - [date]
  Key insight: [main takeaway]

RECOMMENDATION:
[Use library X] OR [Adapt pattern from Y] OR [Build custom because Z]

â”â”â” IMPLEMENTATION PLAN â”â”â”
[Then show detailed pseudocode with chosen approach]

Proceed with implementation?
```

**If nothing found:**
```
I searched for solutions (npm, GitHub, Stack Overflow, articles):
- No existing library found for [specific feature]
- Found [related library] that handles [partial functionality]
- Found [article/pattern] with useful approach

RECOMMENDATION:
Build custom using [pattern/approach from search]
+ Integrate [related library] for [partial functionality]

â”â”â” IMPLEMENTATION PLAN â”â”â”
[Then show detailed pseudocode]

Proceed with implementation?
```

### Step 4: Decision Criteria

**Use a library when:**
- âœ… Solves 80%+ of requirements
- âœ… Well-maintained and actively developed
- âœ… Good documentation and community support
- âœ… TypeScript support available
- âœ… Reasonable bundle size
- âœ… Saves significant time vs building

**Adapt patterns from repos/articles when:**
- âœ… Library doesn't exist but pattern does
- âœ… Need to understand architecture approach
- âœ… Can adapt code to your needs
- âœ… Saves research time

**Build from scratch when:**
- âŒ No suitable library OR pattern exists (verified via search)
- âŒ Existing solutions unmaintained (no commits in 12+ months)
- âŒ Library adds significant bundle size for minimal benefit
- âŒ Requirements highly customized (medical workflows, regulatory)
- âŒ Security/privacy concerns with external dependencies

---

## Search Examples

### Example 1: Medical Imaging Feature

**User**: "build medical image annotation tool"

**AI searches**:
1. npm: "medical image annotation react"
2. GitHub: "DICOM viewer react" / "medical imaging annotation"
3. Stack Overflow: "medical image annotation javascript"
4. dev.to: "healthcare image viewer tutorial"
5. Medium: "building medical imaging tools"

**AI finds**:
- Library: `react-konva` (already in package.json!)
- Repo: cornerstone.js (DICOM viewer, 2k stars)
- SO answer: Canvas annotation techniques
- Article: Healthcare annotation best practices

**AI presents**:
```
I searched for solutions:

ðŸ“¦ LIBRARIES FOUND:
- react-konva: 6k stars, last updated 1 month ago
  âœ… Already installed! Canvas-based, handles annotations
  âœ… Good docs, TypeScript support
  Bundle: 50KB

ðŸ” GITHUB REPOS:
- cornerstone.js: 2k stars
  DICOM medical imaging viewer
  Useful for: Medical imaging patterns, DICOM handling

ðŸ’¬ ARTICLES:
- "Building Healthcare Annotation Tools" (Medium)
  Key insight: Layer-based approach for annotations

RECOMMENDATION:
Use react-konva (already installed) for annotation layer
+ Learn DICOM patterns from cornerstone.js if needed

â”â”â” IMPLEMENTATION PLAN â”â”â”
[pseudocode using react-konva]

Proceed with implementation?
```

### Example 2: FHIR Integration

**User**: "build FHIR patient search"

**AI searches**:
1. npm: "fhir client typescript"
2. GitHub: "fhir integration nodejs example"
3. Stack Overflow: "FHIR search parameters"
4. dev.to: "FHIR API tutorial"

**AI finds**:
- Library: `fhir-kit-client`
- Repo: hapi-fhir examples
- SO: FHIR search best practices
- Tutorial: FHIR query patterns

**AI presents**: [findings + recommendation + pseudocode + "Proceed?"]

### Example 3: Nothing Exists

**User**: "build ACC45 occupation code matcher"

**AI searches**:
1. npm: "ACC occupation code" â†’ Nothing
2. GitHub: "ACC45 new zealand" â†’ Nothing relevant
3. Stack Overflow: "fuzzy matching medical codes"
4. Articles: "fuzzy search implementation"

**AI finds**:
- Library: `fuse.js` (fuzzy search, 18k stars)
- SO: Fuzzy matching algorithms
- Article: "Implementing fuzzy search"

**AI presents**:
```
I searched for solutions:

ðŸ“¦ No ACC-specific library exists.

Found general solution:
- fuse.js: 18k stars, fuzzy search library
  âœ… Perfect for code matching, lightweight (12KB)

ðŸ’¬ STACK OVERFLOW:
- "Fuzzy matching for medical terminology"
  Key insight: Levenshtein distance + threshold tuning

RECOMMENDATION:
Build custom ACC matcher using fuse.js for search engine

â”â”â” IMPLEMENTATION PLAN â”â”â”
[pseudocode with fuse.js integration]

Proceed with implementation?
```

---

## Integration with Session Workflow

**This rule runs during THINKING mode for code planning.**

**Workflow:**
1. User: "build X"
2. AI: *enters THINKING mode*
3. AI: *searches npm + GitHub + Stack Overflow + dev.to + Medium*
4. AI: *presents findings*
5. AI: *shows pseudocode plan incorporating findings*
6. AI: "Proceed with implementation?"
7. User: "yes"
8. AI: *enters DOING mode, writes code*

---

## When NOT to Search

**Skip searching for:**
- Tiny utility functions (< 10 lines)
- Features already partially built (refactoring existing code)
- Debugging existing code (fixing bugs)
- Minor refactoring
- User explicitly says "don't search, just build"

---

## Search Quality Tips

**Good searches:**
- âœ… "[specific feature] [tech stack]" â†’ "modal dialog react typescript"
- âœ… "[domain] [pattern]" â†’ "healthcare authentication flow"
- âœ… "[api name] [language] example" â†’ "ALEX api nodejs example"
- âœ… "[problem] best practices" â†’ "medical data validation best practices"

**Bad searches:**
- âŒ Too generic: "component library" (too broad)
- âŒ Wrong stack: "image editor angular" (you use React)
- âŒ Outdated: Filtering for 5+ year old content

---

## Examples from Project Context

**User already uses successfully:**
- Image editing: `react-konva` + `konva` (canvas-based)
- Forms: `react-hook-form` + `zod` (validation)
- UI components: 12x `@radix-ui/*` (accessible components)
- AI: OpenAI, Anthropic, Deepgram SDKs
- Database: Drizzle ORM, Neon PostgreSQL
- Auth: Clerk (full authentication)
- Real-time: Ably
- Payments: Stripe

**When to build custom (domain-specific):**
- Medical imaging workflows (regulatory, privacy)
- FHIR/ALEX API integration (healthcare-specific)
- ACC occupation code matching (NZ-specific)
- Clinical note generation (medical domain)

## Anti-Patterns to Avoid

âŒ **Not searching before building** - Wastes time
âŒ **"I'll build it quickly"** - Often takes longer than integrating
âŒ **"Libraries are bloated"** - Modern libraries tree-shakeable
âŒ **"No time to research"** - 5 min search saves hours of dev

---

# End of Library-First Approach
